<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Light Switch - Joe's Games</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <header>
        <a href="./index.html"><img class="website-logo" src="./resources/joesGamesLogo.png" alt="Joe's Games website logo. Minimalist design with gaming controller. Click here to go to index page."></a>
        <h1>Light Switch</h1>
        <Nav>
            <ul>
                <li><a href="./index.html">Home</a></li>
                <li><a href="./lightswitch.html" aria-current="page" class="currentpage">Lightswitch</a></li>
                <li><a href="./tic-tac-toe.html">Tic-Tac-Toe</a></li>
                <li><a href="./mastermind.html">Mastermind</a></li>
                <li><a href="./about.html">About</a></li>
            </ul>
        </Nav>
    </header>
    <main>
        <!-- leaderboard for fastest time -->
         <div id="lightSwitchContainer">
         <table class="light-switch-table" border="1">
            <caption id="lightSwitchGameTitle">Lightswitch</caption>
            <tr>
                <th class="light-switch-panel" id="0,2"></th>
                <th class="light-switch-panel" id="1,2"></th>
                <th class="light-switch-panel" id="2,2"></th>
            </tr>
            <tr>
                <th class="light-switch-panel" id="0,1"></th>
                <th class="light-switch-panel" id="1,1"></th>
                <th class="light-switch-panel" id="2,1"></th>
            </tr>
            <tr>
                <th class="light-switch-panel" id="0,0"></th>
                <th class="light-switch-panel" id="1,0"></th>
                <th class="light-switch-panel" id="2,0"></th>
            </tr>
         </table>
         </div>
         <script>
            let lightSwitchArray = [[document.getElementById("0,0"),document.getElementById("0,1"),document.getElementById("0,2")],
                                    [document.getElementById("1,0"),document.getElementById("1,1"),document.getElementById("1,2")],
                                    [document.getElementById("2,0"),document.getElementById("2,1"),document.getElementById("2,2")]];
            let lightSwitchPanelState = [[false,false,false],
                                        [false,false,false],
                                        [false,false,false]]
            let numLightsOn = 0
            let lightTitle = document.getElementById("lightSwitchGameTitle")
            let clickedX;
            let clickedY;
            for (row=0; row < 3; row++){
                for (column=0; column < 3; column++){
                    // console.log("on row " + row + " and column " + column);
                    lightSwitchArray[row][column].addEventListener("click", function(){clickLight(this)});
                    if (Math.random() > .5){
                        lightSwitchPanelState[row][column] = true;
                        lightSwitchArray[row][column].style.backgroundColor = "#FFD105";
                        numLightsOn++;
                    }
                }
            }

            function clickLight(panel){
                // panel.style.backgroundColor = "#000000";
                clickedX = Number(panel.id.charAt(0));
                clickedY = Number(panel.id.charAt(2));
                // lightSwitchPanelState[clickedX][clickedY] = true;
                // console.log("the id of this is " + clickedX + "," + clickedY + lightSwitchPanelState[clickedX][clickedY]);
                // console.log(`the state of ${clickedX - 1}, ${clickedY} is ${lightSwitchPanelState[clickedX - 1][clickedY]}`)
                if (lightSwitchPanelState[clickedX][clickedY]){
                        lightSwitchPanelState[clickedX][clickedY] = false;
                        panel.style.backgroundColor = "#000000";
                        numLightsOn--;
                    }
                    else{
                        lightSwitchPanelState[clickedX][clickedY] = true;
                        panel.style.backgroundColor = "#FFD105"
                        numLightsOn++;
                    }
                if (clickedX - 1 > -1){
                    if (lightSwitchPanelState[clickedX - 1][clickedY]){
                        lightSwitchPanelState[clickedX - 1][clickedY] = false;
                        lightSwitchArray[Number(clickedX) - 1][Number(clickedY)].style.backgroundColor = "#000000";
                        numLightsOn--;
                    }
                    else{
                        lightSwitchPanelState[clickedX - 1][clickedY] = true;
                        lightSwitchArray[Number(clickedX) - 1][Number(clickedY)].style.backgroundColor = "#FFD105"
                        numLightsOn++;
                    }
                }
                if (clickedX + 1 < 3){
                    if (lightSwitchPanelState[clickedX + 1][clickedY]){
                        lightSwitchPanelState[clickedX + 1][clickedY] = false;
                        lightSwitchArray[Number(clickedX) + 1][Number(clickedY)].style.backgroundColor = "#000000";
                        numLightsOn--;
                    }
                    else{
                        lightSwitchPanelState[clickedX + 1][clickedY] = true;
                        lightSwitchArray[Number(clickedX) + 1][Number(clickedY)].style.backgroundColor = "#FFD105"
                        numLightsOn++;
                    }
                }
                if (clickedY - 1 > -1){
                    if (lightSwitchPanelState[clickedX][clickedY - 1]){
                        lightSwitchPanelState[clickedX][clickedY - 1] = false;
                        lightSwitchArray[Number(clickedX)][Number(clickedY - 1)].style.backgroundColor = "#000000";
                        numLightsOn--;
                    }
                    else{
                        lightSwitchPanelState[clickedX][clickedY - 1] = true;
                        lightSwitchArray[Number(clickedX)][Number(clickedY - 1)].style.backgroundColor = "#FFD105"
                        numLightsOn++
                    }
                }
                if (clickedY + 1 < 3){
                    if (lightSwitchPanelState[clickedX][clickedY + 1]){
                        lightSwitchPanelState[clickedX][clickedY + 1] = false;
                        lightSwitchArray[Number(clickedX)][Number(clickedY + 1)].style.backgroundColor = "#000000";
                        numLightsOn--;
                    }
                    else{
                        lightSwitchPanelState[clickedX][clickedY + 1] = true;
                        lightSwitchArray[Number(clickedX)][Number(clickedY + 1)].style.backgroundColor = "#FFD105"
                        numLightsOn++;
                    }
                }
                if (numLightsOn == 0){
                    lightTitle.textContent = "You win! Refresh to start a new game.";
                }
            }
         </script>
        <h2 class="Under Construction">This page is under construction!!</h2>
        <p>This is a temporary page for testing. This will eventually be the home of LightSwitch, a game inspired by <a href="https://en.wikipedia.org/wiki/Lights_Out_(game)">Lights Out</a>.</p>
        <p>This is a common game for beginner programmers to recreate for practice. Currently my version is playable and will tell you if you've won in the title, but you need to refresh to get a new game.</p>
        <p>Refresh the page to start a new game. The goal is to turn off all of the lights. Clicking a square changes its state, as well as the adjacent squares' states.</p>
    </main>
</body>
</html>