<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe - Joe's Games</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <header>
        <a href="./index.html"><img class="website-logo" src="./resources/joesGamesLogo.png" alt="Joe's Games website logo. Minimalist design with gaming controller. Click here to go to index page."></a>
        <h1>Tic-Tac-Toe</h1>
        <Nav>
            <ul>
                <li><a href="./index.html">Home</a></li>
                <li><a href="./lightswitch.html">Lightswitch</a></li>
                <li><a href="./tic-tac-toe.html" aria-current="page" class="currentpage">Tic-Tac-Toe</a></li>
                <li><a href="./mastermind.html">Mastermind</a></li>
                <li><a href="./about.html">About</a></li>
            </ul>
        </Nav>
    </header>
    <main>
        <!-- leaderboard for consecutive wins -->
         <!-- vs computer or vs human. computer does a random spot that is free each round -->
         <div class="tic-tac-toe-form-container">
            <p><strong>Form in development; no functionality as of yet.</strong></p>
            <form class="tictactoe-opponent-form" action="">
                <p>
                    <label for="vsHuman">vs. Human</label>
                    <input type="radio" name="chooseOpponent" id="vsHuman">
                    <label for="vsComputer">vs. Computer</label>
                    <input type="radio" name="chooseOpponent" id="vsComputer">
                </p>
                <p>
                    <input type="button" value="Submit" id="chooseOpponentSubmit">
                </p>
            </form>
            <form class="tictactoe-player-customization-form hidden" action="">
                <p>
                    <label for="playerOneNameField">Player One Name:</label>
                    <input type="text" name="playerNames" id="playerOneNameField">
                    <label for="playerOneColorChooser">Choose player one's color:</label>
                    <input type="color" name="playerColors" id="playerOneColorChooser">
                </p>
                <p>
                    <label for="playerTwoNameField">Player Two Name:</label>
                    <input type="text" name="playerNames" id="playerTwoNameField">
                    <label for="playerTwoColorChooser">Choose player two's color:</label>
                    <input type="color" name="playerColors" id="playerTwoColorChooser">
                </p>
                <p>
                    <input type="button" value="Submit" id="playerCustomizationSubmit">
                </p>
            </form>
        </div>
        <table class="tic-tac-toe-table" border="1">
            <caption id="ticTacToeGameTitle"><strong>Tic-Tac-Toe: playerOne's turn.</strong></caption>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_0"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_1"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_2"></th>
            </tr>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_3"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_4"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_5"></th>
            </tr>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_6"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_7"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_8"></th>
            </tr>
        </table>
        <script>
            let ticTacToeArray = []
            for (i = 0; i < 9; i++){
                ticTacToeArray[i] = document.getElementById(`ticTacToe_${i}`)
                ticTacToeArray[i].addEventListener("click", function(){clickTicTacToe(this)})
            }
            let winningCombos = ["012","036","048","147","246","258","345","678"];
            let playerOneTiles = [];
            let playerTwoTiles = [];
            let playerOneName = "";
            let playerTwoName = "";
            let playerOneColor = "#0000FF";
            let playerTwoColor = "#00FF00";
            let currentPlayerTurn = "playerOne"
            let clickedTile
            let comboChecker = 0;
            let comboTiles = [];
            let winner = "";
            let round = 0;
            let gameTitle = document.getElementById("ticTacToeGameTitle");

            function clickTicTacToe(ticTacPanel){
                clickedTile = ticTacPanel.id.charAt(10)
                if (ticTacPanel.textContent == "" && winner == ""){
                    if (currentPlayerTurn == "playerOne"){
                        playerOneTiles[clickedTile] = clickedTile;
                        ticTacPanel.textContent = "X";
                        ticTacPanel.classList.remove("empty");
                        checkWin(playerOneTiles);
                        if (winner == ""){
                            currentPlayerTurn = "playerTwo";
                            gameTitle.textContent = `Tic-Tac-Toe: ${currentPlayerTurn}'s turn.`
                        }
                    }
                    else {
                        playerTwoTiles[clickedTile] = clickedTile;
                        ticTacPanel.textContent = "O";
                        ticTacPanel.classList.remove("empty");
                        checkWin(playerTwoTiles);
                        if (winner == ""){
                            currentPlayerTurn = "playerOne";
                            gameTitle.textContent = `Tic-Tac-Toe: ${currentPlayerTurn}'s turn.`
                        }
                    }
                    round++;
                    if (round == 9 && winner == "")
                    {
                        winner = "tie";
                        gameTitle.textContent = "It's a tie!"
                    }
                }
            }

            function checkWin(playerTiles){
                 for (let combo of winningCombos){
                    comboChecker = 0;
                    for (i = 0; i < 3; i++){
                        // console.log(`playerOneTiles is ${playerTiles} the current digit of combo ${combo} is ${combo.charAt(i)}`)
                        if (playerTiles.indexOf(combo.charAt(i)) > -1){
                            comboChecker++
                            comboTiles[i] = combo.charAt(i);
                        }
                        else{
                            comboChecker = 0;
                            break;
                        }
                        // console.log(`combo checked. i is ${i}. ${currentPlayerTurn}'s combo is ${comboChecker}.`)
                    }
                    if (comboChecker == 3){
                        winner = currentPlayerTurn;
                        gameTitle.textContent = `${winner} is the winner!!`;
                        for (i = 0; i < 3; i++){
                            if (winner == "playerOne"){
                                ticTacToeArray[comboTiles[i]].style.backgroundColor = playerOneColor;
                            }
                            else{
                                ticTacToeArray[comboTiles[i]].style.backgroundColor = playerTwoColor;
                            }
                            ticTacToeArray[comboTiles[i]].style.color = "#FFFFFF";
                        }
                        for (i=0; i < 9; i++){
                            if (ticTacToeArray[i].textContent == ""){
                                ticTacToeArray[i].classList.remove("empty");
                            }
                        }
                        break;
                    }
                }
            }
        </script>
        <h2 class="Under Construction">This page is under construction!!</h2>
        <p>This is a temporary page for testing. This will eventually be the home of <a href="https://en.wikipedia.org/wiki/Tic-tac-toe">Tic-Tac-Toe</a>.</p>
        <p>There will eventually be a form that asks each player for their name, and it will say "____'s turn". There will also be a radial button choice of playing against a human or a computer opponent.</p>
        <p>The game can be played in its current state, but it has generic names for each player. You also must refresh to do a new game.</p>
</body>
</html>