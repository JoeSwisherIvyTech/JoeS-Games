<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe - Joe's Games</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <header>
        <a href="./index.html"><img class="website-logo" src="./resources/joesGamesLogo.png" alt="Joe's Games website logo. Minimalist design with gaming controller. Click here to go to index page."></a>
        <h1>Tic-Tac-Toe</h1>
        <Nav>
            <ul>
                <li><a href="./index.html">Home</a></li>
                <li><a href="./lightswitch.html">Lightswitch</a></li>
                <li><a href="./tic-tac-toe.html" aria-current="page" class="currentpage">Tic-Tac-Toe</a></li>
                <li><a href="./mastermind.html">Mastermind</a></li>
                <li><a href="./about.html">About</a></li>
            </ul>
        </Nav>
    </header>
    <main>
        <!-- leaderboard for consecutive wins -->
         <!-- vs computer or vs human. computer does a random spot that is free each round -->
         <div class="tic-tac-toe-form-container">
            <!-- <p><strong>Form in development; no functionality as of yet.</strong></p> -->
            <!-- <form class="tictactoe-opponent-form" action="">
                <p>
                    <label for="vsHuman">vs. Human</label>
                    <input type="radio" name="chooseOpponent" id="vsHuman">
                    <label for="vsComputer">vs. Computer</label>
                    <input type="radio" name="chooseOpponent" id="vsComputer">
                </p>
                <p>
                    <input type="button" value="Submit" id="gameModeSubmit">
                </p>
            </form> -->
            <form class="tictactoe-player-customization-form" id="playerCustomizationForm" action="">
                <p>
                    <label for="playerOneNameField">Player One Name:</label>
                    <input type="text" name="playerNames" id="playerOneNameField" value="playerOne">
                    <label for="playerOneColorChooser">Choose player one's color:</label>
                    <input type="color" name="playerColors" id="playerOneColorPicker" value="#0000FF">
                </p>
                <p class="nameInvalid dont-display" id="nameOneInvalid">
                    Please input a name.
                </p>
                <p>
                    <label for="playerTwoNameField">Player Two Name:</label>
                    <input type="text" name="playerNames" id="playerTwoNameField" value="playerTwo">
                    <label for="playerTwoColorChooser">Choose player two's color:</label>
                    <input type="color" name="playerColors" id="playerTwoColorPicker" value="#FF0000">
                </p>
                <p class="nameInvalid dont-display" id="nameTwoInvalid">
                    Please input a name.
                </p>
                <p>
                    <input type="button" value="Submit" id="playerCustomizationSubmit">
                </p>
            </form>
        </div>
        <table class="tic-tac-toe-table dont-display" id="ticTacToeTable" border="1">
            <caption id="ticTacToeGameTitle"><strong>Tic-Tac-Toe: playerOne's turn.</strong></caption>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_0"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_1"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_2"></th>
            </tr>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_3"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_4"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_5"></th>
            </tr>
            <tr>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_6"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_7"></th>
                <th class="tic-tac-toe-panel empty" id="ticTacToe_8"></th>
            </tr>
        </table>
        <script>
            let ticTacToeArray = []
            for (i = 0; i < 9; i++){
                ticTacToeArray[i] = document.getElementById(`ticTacToe_${i}`)
                ticTacToeArray[i].addEventListener("click", function(){clickTicTacToe(this)})
            }
            let winningCombos = ["012","036","048","147","246","258","345","678"];
            let playerOneTiles = [];
            let playerTwoTiles = [];
            let playerOneName = "";
            let playerTwoName = "";
            let playerOneColor = "#0000FF";
            let playerTwoColor = "#FF0000";
            let currentPlayerTurn = "playerOne"
            // gameModeSelectButton = document.getElementById("gameModeSubmit");
            // gameModeSelectButton.addEventListener("click", function(){gameModeSelect()})
            playerCustomizationSubmitButton = document.getElementById("playerCustomizationSubmit");
            playerCustomizationSubmitButton.addEventListener("click", function(){playerCustomizationSubmission()})
            playerOneNameField = document.getElementById("playerOneNameField");
            nameOneInvalid = document.getElementById("nameOneInvalid");
            playerOneNameField.addEventListener("input", function(){validateName(this, nameOneInvalid)})
            playerTwoNameField = document.getElementById("playerTwoNameField");
            nameTwoInvalid = document.getElementById("nameTwoInvalid");
            playerTwoNameField.addEventListener("input", function(){validateName(this, nameTwoInvalid)})
            playerOneColorPicker = document.getElementById("playerOneColorPicker");
            playerTwoColorPicker = document.getElementById("playerTwoColorPicker");
            playerCustomizationForm = document.getElementById("playerCustomizationForm");
            ticTacToeTable = document.getElementById("ticTacToeTable");
            let clickedTile
            let comboChecker = 0;
            let comboTiles = [];
            let winner = "";
            let round = 0;
            let gameTitle = document.getElementById("ticTacToeGameTitle");

            // function gameModeSelect(){

            // }
            function playerCustomizationSubmission(){
                if (playerOneNameField.value.trim() != ""){
                    playerOneName = playerOneNameField.value;
                }
                else{
                    playerOneName = "playerOne";
                }
                if (playerTwoNameField.value.trim() != ""){
                    playerTwoName = playerTwoNameField.value;
                }
                else{
                    playerTwoName = "playerTwo";
                }
                playerOneColor = playerOneColorPicker.value;
                playerTwoColor = playerTwoColorPicker.value;
                currentPlayerTurn = playerOneName;
                gameTitle.textContent = `Tic-Tac-Toe: ${currentPlayerTurn}'s turn.`
                gameTitle.style.border = `4px solid ${playerOneColor}`;
                playerCustomizationForm.classList.add("dont-display");
                ticTacToeTable.classList.remove("dont-display");
            }
            function validateName(userName, userNameInvalid){
                if (userName.value.trim() == ""){
                    userNameInvalid.classList.remove("dont-display");
                    userName.style.backgroundColor = "#FF0000";
                    playerCustomizationSubmitButton.disabled = true;
                }
                else{
                    userNameInvalid.classList.add("dont-display");
                    userName.style.backgroundColor = "#FFFFFF";
                    if (nameOneInvalid.classList.contains("dont-display") && nameTwoInvalid.classList.contains("dont-display")){
                        playerCustomizationSubmitButton.disabled = false;
                    }
                }
            }

            function clickTicTacToe(ticTacPanel){
                clickedTile = ticTacPanel.id.charAt(10)
                if (ticTacPanel.textContent == "" && winner == ""){
                    if (currentPlayerTurn == playerOneName){
                        playerOneTiles[clickedTile] = clickedTile;
                        ticTacPanel.textContent = "X";
                        ticTacPanel.classList.remove("empty");
                        checkWin(playerOneTiles);
                        if (winner == ""){
                            currentPlayerTurn = playerTwoName;
                            gameTitle.textContent = `Tic-Tac-Toe: ${currentPlayerTurn}'s turn.`
                            gameTitle.style.border = `4px solid ${playerTwoColor}`;
                        }
                    }
                    else {
                        playerTwoTiles[clickedTile] = clickedTile;
                        ticTacPanel.textContent = "O";
                        ticTacPanel.classList.remove("empty");
                        checkWin(playerTwoTiles);
                        if (winner == ""){
                            currentPlayerTurn = playerOneName;
                            gameTitle.textContent = `Tic-Tac-Toe: ${currentPlayerTurn}'s turn.`
                            gameTitle.style.border = `4px solid ${playerOneColor}`;
                        }
                    }
                    round++;
                    if (round == 9 && winner == "")
                    {
                        winner = "tie";
                        gameTitle.textContent = "It's a tie! Refresh to play again."
                        gameTitle.style.border = `4px solid #000000`;
                    }
                }
            }

            function checkWin(playerTiles){
                 for (let combo of winningCombos){
                    comboChecker = 0;
                    for (i = 0; i < 3; i++){
                        // console.log(`playerOneTiles is ${playerTiles} the current digit of combo ${combo} is ${combo.charAt(i)}`)
                        if (playerTiles.indexOf(combo.charAt(i)) > -1){
                            comboChecker++
                            comboTiles[i] = combo.charAt(i);
                        }
                        else{
                            comboChecker = 0;
                            break;
                        }
                        // console.log(`combo checked. i is ${i}. ${currentPlayerTurn}'s combo is ${comboChecker}.`)
                    }
                    if (comboChecker == 3){
                        winner = currentPlayerTurn;
                        gameTitle.textContent = `${winner} is the winner!! Refresh to play again.`;
                        for (i = 0; i < 3; i++){
                            if (winner == "playerOne"){
                                ticTacToeArray[comboTiles[i]].style.backgroundColor = playerOneColor;
                                gameTitle.style.border = `4px solid ${playerOneColor}`;
                            }
                            else{
                                ticTacToeArray[comboTiles[i]].style.backgroundColor = playerTwoColor;
                                gameTitle.style.border = `4px solid ${playerTwoColor}`;
                            }
                            ticTacToeArray[comboTiles[i]].style.color = "#FFFFFF";
                        }
                        for (i=0; i < 9; i++){
                            if (ticTacToeArray[i].textContent == ""){
                                ticTacToeArray[i].classList.remove("empty");
                            }
                        }
                        break;
                    }
                }
            }
        </script>
        <h2 class="Under Construction">This page is under construction!!</h2>
        <p>This is a temporary page for testing. This will eventually be the home of <a href="https://en.wikipedia.org/wiki/Tic-tac-toe">Tic-Tac-Toe</a>.</p>
        <p>There will eventually be a form that asks each player for their name, and it will say "____'s turn". There will also be a radial button choice of playing against a human or a computer opponent.</p>
        <p>The game can be played in its current state, but it has generic names for each player. You also must refresh to do a new game.</p>
</body>
</html>